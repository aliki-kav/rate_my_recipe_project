{% extends 'rmr/base.html' %}
{% load static %}

{% block title_block %}
        Login
{% endblock %}

{% block head_block %}
        <link rel="stylesheet" type="text/css" href="{% static 'login.css' %}">
        <script>
         $(document).ready(function () {
          const loginForm = $('#login_form');

          loginForm.on('submit', async function (event) {
            event.preventDefault();
            const response = await fetch('{% url "rmr:login" %}', {
              method: 'POST',
              body: new FormData(loginForm[0]),
              headers: {
                'X-CSRFToken': '{{ csrf_token }}',
              },
            });
            const data = await response.json();
            if (data.success) {
              alert('Welcome back!');
              window.location.href = '{% url "rmr:index" %}';
            } else {
              alert('Wrong username or password provided. Please try again.');
            }
          });
        });

</script>
{% endblock %}

{% block body_block %}
<section class="vh-100">
  <div class="mask d-flex align-items-center h-100 gradient-custom-1">
    <div class="container h-100">
      <div class="row d-flex justify-content-center align-items-center h-100">
        <div class="col-12 col-md-9 col-lg-7 col-xl-6">
          <div class="card hover-box" style="border-radius: 25px;">
            <div class="card-body p-5">
              <h2 class="text-uppercase text-center mb-5">Login to RMR</h2>

              <form id="login_form" method="post" action="{% url 'rmr:login' %}" >
                {% csrf_token %}

                <div class="form-outline mb-4">
                  <label class="form-label">Username</label>
                    <input type="text" name="username" value=""   class="form-control " required />
                </div>

                <div class="form-outline mb-4">
                  <label class="form-label" >Password</label>

                  <input type="password" name="password" value="" class="form-control " required />
                </div>

                <div class="d-flex justify-content-center">
                  <input type="submit" name="submit" value="Login" class="btn btn-primary btn-block btn-lg gradient-custom-2 text-body"/>
                </div>

                <p class="text-center text-muted mt-5 mb-0">Don't have an account? <a href="{% url 'rmr:register' %}" class="fw-bold text-body"><u>Register here</u></a></p>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}
